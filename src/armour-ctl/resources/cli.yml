name: armour-ctl
version: "1.0"
about: Armour control command line tool
args:
  - CONTROLPLANEURL:
      help: control plane URL
      short: c
      long: control
      takes_value: true
      value_name: URL
subcommands:
  - list:
      about: List hosts, services or policies
      args:
        - ENTITY:
            index: 1
            possible_values: 
                - hosts
                - services
                - policies
  - update:
      about: Update a policy
      args:
        - POLICYFILE:
            short: p
            long: policy
            required: true
            takes_value: true
            value_name: "policy filename"
            help: Input policy file
        - SERVICE:
            short: s
            long: service
            required: true
            takes_value: true
            value_name: "service label"
            help: Service label
        - LABELS:
            short: l
            long: label
            required: false
            takes_value: true
            multiple: true
            number_of_values: 2
            value_names:
                - "url"
                - "label"
            help: Policy labels
  - query:
      about: Query a policy
      args:
        - SERVICE:
            short: s
            long: service
            required: true
            takes_value: true
            help: Service label
  - drop-all:
      about: Remove all policies
  - drop:
      about: Remove a policy
      args:
        - SERVICE:
            short: s
            long: service
            required: true
            takes_value: true
            help: Service label
