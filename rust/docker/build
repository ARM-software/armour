#!/usr/bin/env bash
set -e
set -x
# Build rust binary
cd ..
for i in "${@:2}"
do
  cargo build --target-dir $1 --release -p $i
  cp $1/release/$i "$OLDPWD"
done
cd -
if [ ! -z "$3" ]
then
  docker build --build-arg BINARY=$2 --build-arg BINARY2=$3  -t $2 .
else
  docker build --build-arg BINARY=$2 -t $2 .
fi
docker images
echo "Done"
